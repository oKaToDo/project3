<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>News</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/profile_style.css') }}"/>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    </head>
    <header>
		<nav class="navbar navbar-expand-lg navbar-light">
		 	<div class="container-fluid">
		  		<a class="navbar-brand" href="/news">
      				<img src="{{ url_for('static', filename='pictures/logo.png') }}" alt="" width="35" height="30" class="d-inline-block align-text-top">
      				Films
    			</a>
				<form class="container-fluid justify-content-start" method="POST">
					<button class="btn btn-outline-secondary" type="submit" name="header_btn" value="Home">Домой</button>
					<button class="btn btn-outline-secondary" type="submit" name="header_btn" value="Profile">Профиль</button>
				</form>
				<div class="d-flex">
      				<button class="btn btn-outline-dark" type="button" name="header_btn" value="search" data-bs-toggle="modal" data-bs-target="#exampleModal">Найти</button>
      				<!-- Modal -->			
					<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
						<form method="POST">
							<div class="modal-dialog">
								<div class="modal-content">
							    	<div class="modal-header">
								        <h5 class="modal-title" id="exampleModalLabel">Поиск фильма по параметрам</h5>
								        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
							      	</div>
							      	<div class="modal-body">
								        <label for="exampleFormControlInput1" class="form-label">Название фильма</label>
	           							<input type="text" class="form-control" id="exampleFormControlInput1" name="movie_title">
	           							<br>

								        <select class="form-select" aria-label="Default select example" name="genreOfFilm">
									    	<option selected>Жанр</option>
									        	<option value="Анимэ">Анимэ</option>
									            <option value="Биография">Биография</option>
									            <option value="Боевик">Боевик</option>
									            <option value="Вестерн">Вестерн</option>
									            <option value="Военный">Военный</option>
									            <option value="Детектив">Детектив</option>
									            <option value="Документальный">Документальный</option>
									            <option value="Документальный">Драма</option>
									            <option value="История">История</option>
									            <option value="Комедия">Комедия</option>
									            <option value="Мелодрама">Мелодрама</option>
									            <option value="Мультфильм">Мультфильм</option>
									            <option value="Приключения">Приключения</option>
									            <option value="Триллер">Триллер</option>
									            <option value="Ужасы">Ужасы</option>
									           <option value="Фантастика">Фантастика</option>
									    </select>
									    <br>

									    <label for="exampleFormControlInput1" class="form-label">Год выпуска</label>
	            						<input type="text" class="form-control year" id="exampleFormControlInput1" name="movie_year">
	            						<br>

	            						<label for="type_of_sort_select" class="form-label">Сортировать по</label>
	            						<select class="form-select" aria-label="Default select example" name="type_of_sort" id="type_of_sort_select">
									        <option value="title_filter" selected="">Названию</option>
									        <option value="year_filter">Году выхода</option>
									        <option value="marks_filter">Оценкам</option>
									        <option value="count_filter">Количеству отзывов</option>
									    </select>
							      	</div>
								    <div class="modal-footer">
								      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
								      <button type="submit" name="submit_btn" class="btn btn-primary">Найти</button>
								    </div>
							    </div>
							</div>
						</form>
					</div>
    			</div>
    			<form method="POST">
	    			<button type="submit" class="btn btn-outline-secondary" name="header_btn" value="Logout">
	                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
	 					<path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"></path>
	  					<path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"></path>
					</svg>
	              </button>
          		</form>
		 	</div>
		</nav>
    </header>
    <body>
    	<div class="profile_info">
	    	<div class="photo_style">
	    		<img src="{{ image_route }}" alt="Не удалость загрузить фото" width="300" height="300">
	    		<form method="POST" enctype="multipart/form-data"> 			
	    			<div class="input__wrapper">
					   <input name="file" type="file" id="input__file" class="input input__file" multiple>
					   <label for="input__file" class="input__file-button">
					      <span class="input__file-icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
						  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
						  <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
						</svg></span>
					      <span class="input__file-button-text">Выберите файл</span>
					   </label>
					   <button type="submit" name="btn" class="btn btn-primary confirm_new_photo" value="edit_photo">Изменить аватарку</button>
					</div>				
	    		</form>
	    		<div class="info">
	    			<form method="POST">
		    			<h1>{{ name }}</h1>
		    			<h6 class="text_profile">Дата регистрации: {{ reg_data }}</h6>
		    			<h4 class="text_profile">Рецензий на фильмы: {{ count_reviews }}</h4>

		    			<button type="submit" name="btn" class="btn btn-primary writeNew" value="write_new_review"> + Написать новый отзывы</button>
		    		</form>
	    		</div>
	    		<div class="loginForm">
					{% block content %}
					{% for item in reviews%}
					<div>
						<form class="login_form" method="POST">
							<h2>{{item.title}} ({{ item.year }}) {{item.genre}}</h2>
							<h5>Оценка: {{item.mark}}</h5>
							<div>
								{{item.review}}
							</div>
							<div>
							    Дата написания - {{item.date}}
							</div>
							<div class="btns">					
			                    <a href="/change_review/{{ item.id }}" name="btn" class="btn btn-primary" value="change">Изменить</a>
			                    <a href="/delete_review/{{ item.id }}" name="btn" class="btn btn-primary delete" value="delete">Удалить</a> 
			                </div>
						</form>
					</div>
					<br>
					{% endfor %}
					{% endblock %}
				</div>
	    	</div>
	    </div>
	    <script>
		    let inputs = document.querySelectorAll('.input__file');
		    Array.prototype.forEach.call(inputs, function (input) {
		      let label = input.nextElementSibling,
		        labelVal = label.querySelector('.input__file-button-text').innerText;
		  
		      input.addEventListener('change', function (e) {
		        let countFiles = '';
		        if (this.files && this.files.length >= 1)
		          countFiles = this.files.length;
		  
		        if (countFiles)
		          label.querySelector('.input__file-button-text').innerText = 'Файл выбран'
		      });
		    });
		</script>
    </body>